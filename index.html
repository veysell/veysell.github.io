<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* İsteğe bağlı özel stiller */
        #humanBody {
            position: relative;
            width: 100%;
            height: auto;
            background: no-repeat;
            background-size: contain;
            cursor: pointer;
        }

        .result {
            display: none; /* Başlangıçta gizli */
            border: 1px solid #000;
            /* Border rengi ve kalınlığı */
            border-radius: 2px;
            /* Kenar yarıçapı */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            /* Gölgelenme efekti */
            padding: 10px;
            /* İçerik ile border arasındaki boşluk */
        }

        .question {
            display: none;
        }
    </style>
    <title>Human Body Pain Map</title>
</head>

<body>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-6">
                <!-- Sol taraf - İnsan resmi -->
                <div class="mt-3 mb-3">
                    <img id="humanBody" src="path/baby.jpg" alt="">
                </div>
            </div>
            <div class="col-md-6">
                <!-- Sağ taraf - Sonuçlar -->
                <div id="resultContainer" class="mt-3 result mb-3">
                    <div id="resultContent"></div>
                    <div id="symptoms">

                    </div>
                </div>
                <!-- Soruları gösteren alan -->
                <div id="questionContainer" class="question">
                    <h4 id="questionText"></h4>
                    <button class="btn btn-success" onclick="answerQuestion('Evet')">Evet</button>
                    <button class="btn btn-danger" onclick="answerQuestion('Hayır')">Hayır</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script src="/js/decisionTree.js"></script>
  
    <script>
        var symptomIds = {};
        var currentQuestionNode = null;

        document.getElementById('humanBody').addEventListener('click', function (event) {
            var x = (event.clientX - this.getBoundingClientRect().left) / this.clientWidth * 100;
            var y = (event.clientY - this.getBoundingClientRect().top) / this.clientHeight * 100;

            var selectedDisease = "";

            if (x >= 40 && x <= 50 && y >= 20 && y <= 30) {
                selectedDisease = "Göz Hastalıkları";
            } else if (x >= 55 && x <= 65 && y >= 10 && y <= 20) {
                selectedDisease = "Boşaltım Sistemi Hastalıkları";
            } else {
                hideResult();
                return;
            }

            currentQuestionNode = decisionTree[selectedDisease];
            askCurrentQuestion();
        });

        function askCurrentQuestion() {
            var question = Object.keys(currentQuestionNode)[0];
            var questionText = document.getElementById('questionText');
            questionText.innerText = question;

            // Show the question container
            document.getElementById('questionContainer').style.display = 'block';
        }

        function answerQuestion(userAnswer) {
            // Hide the question container
            document.getElementById('questionContainer').style.display = 'none';

            var answers = currentQuestionNode[Object.keys(currentQuestionNode)[0]];

            if (answers[userAnswer]) {
                if (typeof answers[userAnswer] === 'string') {
                    displayResult(answers[userAnswer], 'Description of ' + answers[userAnswer] + '...', []);
                } else {
                    currentQuestionNode = answers[userAnswer];
                    askCurrentQuestion();
                }
            } else {
                hideResult();
            }
        }

        function displayResult(title, description, symptoms) {
            // Display the result on the right side
            var resultContent = document.getElementById('resultContent');
            resultContent.innerHTML = `
                <h4>${title}</h4>
                <p>${description}</p>
            `;

            if (symptoms && symptoms.length > 0) {
                // Display symptoms dynamically in the form
                var symptomForm = document.getElementById('symptomForm');
                symptomForm.innerHTML = ''; // Clear previous content

                symptoms.forEach(function (symptom, index) {
                    // Generate unique ID for each symptom
                    var symptomId = index.toString();
                    symptomIds[symptom] = symptomId;

                    var checkbox = document.createElement('div');
                    checkbox.className = 'form-check';
                    checkbox.innerHTML = `
                        <input class="form-check-input" type="checkbox" value="${symptom}" id="${symptomId}">
                        <label class="form-check-label" for="${symptomId}">${symptom}</label>
                    `;
                    symptomForm.appendChild(checkbox);
                });
            }

            // resultContent'i görünür yap
            document.getElementById('resultContainer').style.display = 'block';
            document.getElementById('symptoms').style.display = 'block';

            // Hide all painInfo elements
            hideAllPainInfo();
        }

        function hideResult() {
            // Hide the result on the right side
            document.getElementById('resultContainer').style.display = 'none';

            // Hide all painInfo elements
            hideAllPainInfo();
        }

        function hideAllPainInfo() {
            // Hide all painInfo elements
            var painInfos = document.getElementsByClassName('painInfo');
            for (var i = 0; i < painInfos.length; i++) {
                painInfos[i].style.display = 'none';
            }
        }

        function getSelectedSymptoms() {
            var symptoms = [];
            var checkboxes = document.querySelectorAll('#symptomForm input[type="checkbox"]:checked');
            checkboxes.forEach(function (checkbox) {
                symptoms.push({
                    id: symptomIds[checkbox.value],
                    name: checkbox.value
                });
            });

            // Display selected symptoms in the result container
            var symptomsText = symptoms.length > 0 ? symptoms.map(symptom => `${symptom.name} (ID: ${symptom.id})`).join(', ') : 'Belirtiler seçilmedi.';
            displayResult('Seçilen Belirtiler', symptomsText, symptoms);
            document.getElementById('symptoms').style.display = 'none';
        }
    </script>
</body>

</html>
